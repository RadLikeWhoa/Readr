// TODO: CHECK
if(options.gaTracking){var _gaq=[["_setAccount",variables.gaTrackingCode],["_trackPageview"]];(function(e,t){var n=e.createElement(t),r=e.getElementsByTagName(t)[0];n.src=("https:"===location.protocol?"//ssl":"//www")+".google-analytics.com/ga.js";r.parentNode.insertBefore(n,r)})(document,"script")}var Readr=function(){var e,t=50,n=15,r="swiped",i=20,s=250,o="ontouchstart"in document.documentElement,u=!1,a=$(document),f=document.getElementById("jsLoadMore"),l=function(e){options.animatePageScrolling?$("html, body").animate({scrollTop:e},s):a.scrollTop(e)};return{writeWordNumber:function(){var t=$(".post-info");if(t.length){var n=t.parent().prev(".text")[0],r=n?e.countwords($(n).find(".body").text()):0;r&&t.append('<li class="info-child"><b>Words: </b>'+r+" words</li>")}},countwords:function(e){return e.replace(/\s+/g," ").split(" ").length},loadPosts:function(){if(u)return;u=!0;var e=f.href,t=e.split("/").pop();f.textContent=localisedStrings.loading+"...";$.ajax({url:e,success:function(n){n=$(n);var r=n.find("#posts").html().trim();if(r.length>0){$(document.getElementById("posts")).append(r);window.history.pushState(null,null,e);options.gaTracking&&_gaq.push(["_trackPageview",e]);if(n.find("#jsLoadMore").length){f.href=e.replace(t,~~t+1);f.textContent=localisedStrings.loadMore}else f.parentNode.removeChild(f)}u=!1},error:function(e,t,n){f.textContent=n;setTimeout(function(){f.textContent=localisedStrings.loadMore;u=!1},3e3)}})},pageNavigation:function(t){var n=a.scrollTop(),r=$(document.getElementById("posts")).find("article"),s=0;if(t==="next"){for(var o=0,u=r.length;o<u;o++){s=$(r[o]).offset().top-i;if(s>n){l(s);return}}if(f){l($(f).offset().top-i);e.loadPosts()}}else if(t==="prev"){for(var o=0,u=r.length;o<u;o++){s=$(r[o]).offset().top-i;if(s>=n){l(0<o?$(r[o-1]).offset().top-i:0);return}}l($(r[--o]).offset().top-i)}},bindUIActions:function(){options.keyboardNav&&$(window).on("keyup",function(t){var n=t.keyCode;39===n||74===n?e.pageNavigation("next"):(37===n||75===n)&&e.pageNavigation("prev")});f&&$(f).on("click",function(t){t.preventDefault();e.loadPosts()})},detectTouch:function(){o?e.bindTouchActions():document.body.classList.add("no-touch")},bindTouchActions:function(){var e,i;$(".posts").on("touchstart","article",function(t){t=t.originalEvent;if(t.touches.length===1){var n=t.touches[0];e=n.pageX;i=n.pageY}});$(".posts").on("touchend","article",function(s){s=s.originalEvent;var o=s.changedTouches,u=$(this);if(o.length===1&&o[0].pageY>i-n&&o[0].pageY<i+n)if(o[0].pageX-e<-t&&!u.hasClass(r)){var a=$("."+r);a.length&&a.removeClass(r);u.addClass(r)}else o[0].pageX-e>t&&u.removeClass(r);else s.preventDefault()})},init:function(){e=this;e.writeWordNumber();e.bindUIActions();e.detectTouch()}}}();Readr.init();